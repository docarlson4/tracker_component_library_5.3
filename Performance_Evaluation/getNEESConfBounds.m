function bounds=getNEESConfBounds(prob,numDim,numMCRuns)%%GETNEESCONFBOUNDS Get the lower and upper bounds of a confidence interval%           in terms of the normalized estimation error equared (NEES) in%           terms of a confidence probability and a number of dimensions.%           This can be used for assessing the consistency of an estimator.%%INPUTS: prob The desired probability bound, for example, 0.99 for 99%.%             (1-prob)/2 is the amount of probability above the bounded%             region and (1-prob)/2 is the amount of probabiity below the%             bounded region.%      numDim The number of dimensions of the estimated variable.%   numMCRuns The number of independent Monte Carlo runs taken when%             computing the NEES.%%OUTPUTS: bounds A 2X1 vector of the form [lower bound;upper bound].%%The NEES is discussed in [1] in term of the inverse chi-squared%distribution. The function ChiSquareD.invCDF is used here to obtain the%bounds.%%REFERENCES:%[1] David F. Crouse , "Basic tracking using nonlinear 3D monostatic and%    bistatic measurements," IEEE Aerospace and Electronic Systems %    Magazine, vol. 29, no. 8, Part II, pp. 4-53, Aug. 2014.%%August 2020 David F. Crouse, Naval Research Laboratory, Washington D.C.%(UNCLASSIFIED) DISTRIBUTION STATEMENT A. Approved for public release.%The amount of probability OUTSIDE of the bounded interval.prob=1-prob;numDegFreedom=numDim*numMCRuns;%Top half of the probabilityboundHigh=ChiSquareD.invCDF(1-prob/2,numDegFreedom)/numDegFreedom;%Botom half of the probabilityboundLow=ChiSquareD.invCDF(prob/2,numDegFreedom)/numDegFreedom;bounds=[boundLow;boundHigh];end